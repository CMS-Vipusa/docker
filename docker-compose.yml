version: '3.9'

services:
  backend:
    image: cmsintern01/payroll-backend:latest
    env_file:
      - backend.env           
    ports:
      - "4000:4000"
    volumes:
      - ./backend/src/uploads:/app/src/uploads
      - ./backend/logs:/app/logs
    command: ["node", "src/server.js"]  # Ensure your backend image has Node installed and server.js exists
    networks:
      - payroll_net
    restart: unless-stopped

  frontend:
    image: cmsintern01/payroll-frontend:latest
    environment:
      VITE_API_URL: http://hexar.dynns.com/api  # Points to backend container, not localhost
    ports:
      - "3000:80"
    depends_on:
      - backend
    networks:
      - payroll_net
    restart: unless-stopped

volumes:
  mysql_data: {}

networks:
  payroll_net:
    driver: bridge
